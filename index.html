<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
<style>
body {
  font-family: "Lato", sans-serif;
}

body::-webkit-scrollbar{
  display: none;
}
.background-container {
  z-index: 1; /* Ensure content is above the pseudo-element */
}

.background-container::-webkit-scrollbar{
  display: none;
}

.background-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: url('jjOf9cbx43.jpg');
  background-size: cover;
  filter: brightness(0.93); /* Example filters */
  z-index: -1; /* Ensure the pseudo-element is behind the content */
  opacity: 0.8;
  background-color:transparent;
}


.sidenav {
  height: 100%;
  width: 0;
  position: fixed;
  z-index: 1;
  top: 60px;
  left: 0;
  background-color: #111;
  overflow-x: hidden;
  transition: 0.5s;
  padding-top: 60px;
  border-top-right-radius: 20px;
}

.sidenav a {
  padding: 8px 8px 8px 32px;
  text-decoration: none;
  font-size: 25px;
  color: #818181;
  display: block;
  transition: 0.3s;
  padding: 15px;
}

.sidenav a:hover {
  color: #f1f1f1;
}

.sidenav .closebtn {
  position: absolute;
  top: 10px;
  right: 25px;
  font-size:50px;
  margin-left: 50px;
}

#main {
  transition: margin-left .5s;
  padding-left: 10px;
  padding-right: 5px;
  max-height: 100%;
  
}
#main::-webkit-scrollbar{
  display: none;
}
.menu-grid {
  max-height:500px;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(153px, .1fr));
  gap: 10px;
  overflow-y: auto;
}

.menu-grid::-webkit-scrollbar{
  display: none;
}

.menu-item {
  padding: 17px;
  background-color: #50c2f7;
  text-align: center;
  cursor: pointer;
  border-radius: 10px;
  font-size: 20px;
  font-weight: bold;
  transition: background-color 0.3s ease;
  height: 40px;
  user-select: none;
  
}

.menu-item:hover {
  background-color: #e0e0e0;
}
#order-list{
  font-size: 16px;
  font-weight: bold;

}
.sysitem{
  font-size: 16px;
  font-weight: bold;
  width: 210px;
  height: 50px;
  background-color: #000000;
  color: white;
  border-radius: 50px;
  border: none;
  cursor: pointer;
  margin-left: 10px;

}
button[type=submit],.supplier{
  font-size: 14px;
  font-weight: bold;
  width: 170px;
  height: 40px;
  background-color: #000000;
  color: white;
  border-radius: 50px;
  border: none;
  cursor: pointer;

}
select:focus {
  border: 2px solid #555;
}

#overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5); /* semi-transparent background */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  
}
.overlay-content {
  position: relative;
  background-color: white;
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  margin: 10px;
  width:50%;
}
.close-button {
  position: absolute;
  top: 10px;
  right: 10px;
  background-color: transparent;
  border: none;
  font-size: 30px;
  cursor: pointer;
}

#add-food-form {
  display: flex;
  flex-direction: column;
  margin: 0 auto; 
}

.form-group {
  display: flex;
flex-direction: row;
  margin-bottom: 15px;
}

.form-group label {
  flex-basis: 30%;
  text-align: left;
  padding-right: 10px;
  margin-top: 7px;
}

.form-group select,.form-group input {
  border-radius: 50px;
  padding: 10px;
  width: 400px;
  border: 2px solid rgb(180, 178, 178);
  outline: none;
  font-size: 14px;
}

button[type="submit"] {
  align-self: flex-end;
  padding: 7px 15px;
}
label{
  font-weight: bold;
}
#dash {
  display: flex;
  justify-content: space-between;
}

#left-side {
  flex: 2; /* Allocates more space for the food items */
  padding: 20px;
  overflow-y: auto;
}

#right-side {
  flex-direction: column;
  justify-content: space-between;
  padding: 20px;
  width: 400px;
}


.order-summary {
  border-radius: 5px;
  padding: 10px;
  margin-bottom: 20px;
  height: 400px;
  margin-top: -15%;
}

.keypad {
  position: absolute;
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-top: 20px;
  margin-bottom: 20px;
}

.keypad button {
  padding: 8px;
  font-size: 1.2em;
  cursor: pointer;
  border-radius: 5px;
  background-color: #eee;
  border: 1px solid #ccc;
}
.keypad button:focus{
  background-color: #a8a6a6;
}

.total {
  font-size: 1.4em;
  text-align: right;
  margin-top: 20px;
  font-weight: bold;
  user-select: none;
}

.cash-input{
  margin-top: 16px;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  font-size: 1.4em;

}
select{
width:410px;
}
.cash-input input{
  border-radius: 50px;
  padding: 10px 20px;
  outline: none;
  border: 2px solid rgb(165, 163, 163);
  font-size: 20px;
  user-select: none;
}
input:focus{
  border: 2px solid rgb(0, 0, 0);
}

.change{
  margin-top: 16px;
  text-align :right;
  font-size: 1.4em;
  font-weight: bold;
  user-select: none;
}

.complete-order-btn {
  margin-top: 20px;
  padding: 13px;
  width: 70%;
  background-color: #000000;
  color: rgb(255, 255, 255);
  border: none;
  border-radius: 50px;
  font-size: 1.2em;
  cursor: pointer;
  font-weight: bold;
  margin-left: 15%;
}
.complete-order-btn:focus {
  background-color: #474747;
  border: none;

}
.sysman:focus,select:focus{
  border: 2px solid rgb(0, 0, 0);
}

#order-list {
    list-style-type: none;
    padding: 0;
    margin: 0;
    width: 100%;
    font-family: Arial, sans-serif;
}

.order-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 5px;
    background-color: transparent;
    margin-bottom: 5px;
    border-radius: 5px;
}
.order-item .item-name {
    flex-grow: 1;
    font-weight: bold;
    font-size: 16px;
}

.order-item .item-quantity {
    width: 50px;
    padding: 8px 15px;
    text-align: center;
    border: 1px solid #ccc;
    border-radius: 50px;
    margin-right: 10px;
}

.order-item .remove-item-btn {
    background-color: #ff4d4d;
    color: white;
    border: none;
    border-radius: 50px;
    padding: 8px 15px;
    cursor: pointer;
}

.order-item .remove-item-btn:hover {
    background-color: #e60000;
}

.order-item .item-price {
    flex-grow: 0;
    font-size: 14px;
    margin-right: 15px;
}
.scrolllist{
  max-height:58%;
  overflow-y: auto;
}

.scrolllist::-webkit-scrollbar {
  display: none;
}
.bottommenu{
  position: absolute;
  bottom: 0;
  margin-bottom: 15%;
}
.reportselect{
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
}
/* Style the supplier table */
.suppliers-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.suppliers-table th, .suppliers-table td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: left;
}

.suppliers-table th {
    background-color: #f4f4f4;
    font-weight: bold;
}

.suppliers-table tr:nth-child(even) {
    background-color: #f9f9f9;
}

.suppliers-table tr:hover {
    background-color: #f1f1f1;
}

.suppliers-table td button {
    padding: 5px 10px;
    margin-right: 5px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 3px;
    cursor: pointer;
}

.suppliers-table td button:hover {
    background-color: #0056b3;
}

.suppliers-table td button.delete {
    background-color: #dc3545;
}

.suppliers-table td button.delete:hover {
    background-color: #c82333;
}

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
}

.pos-container {
    display: flex;
    padding: 20px;
}

.product-section, .checkout-section {
    width: 50%;
    padding: 16px;
}

h2 {
    margin-bottom: 10px;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 8px 12px;
    border: 1px solid #ddd;
    text-align: center;
}

input[type="text"] {
    width: 100%;
    padding: 10px;
    font-size: 18px;
    margin-bottom: 20px;
}

.virtual-keyboard {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
}

.virtual-keyboard button {
    padding: 15px;
    font-size: 18px;
    margin: 5px;
    cursor: pointer;
    border: none;
    background-color: #007bff;
    color: #fff;
    border-radius: 5px;
    width: 20%;
}

.virtual-keyboard button:hover {
    background-color: #0056b3;
}
.removebutton{
  background-color: #dc3545;
  border-radius: 5px;
  color: white;
  border: none;
  outline: none;
  padding: 5px 15px;
}
#inputvalue{
  background-color: transparent;
  outline: none;
  border: none;
  padding: none;
  font-weight: bold;
  text-align: center;
  width: 100px;
}


</style>
</head>
<body>
  
<div class="background-container">
  <span id='bars' style="font-size:30px;cursor:pointer;user-select: none;margin-left:15px;" onclick="openNav()">&#9776;&nbsp;&nbsp&nbsp<b>Restaurant ABC</b></span>
<div id="mySidenav" class="sidenav">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <a href="#" onclick="showMenu()">Dashboard</a>
  <a href="#" onclick="showOrderReports()">Report</a>
  <a href="#" onclick="showInventory()">Inventory</a>
  <a href="#" onclick="showSettings()">Setting</a>
  <a href="#" onclick="loadSystemManagement()">System Manage</a>
</div>
<div id="main">
          
          <script>
showMenu();
  let order = [];
  let total = 0;
  let items = [];

  function openNav() {
        //document.getElementById("bars").style.display = "none";
         //document.getElementById("brand").style.display = "block";
         var n=document.getElementById("mySidenav");
         var m=document.getElementById("main");
          n.style.width =  (n.style.width != '250px' ? '250px' : '0' );
          m.style.marginLeft=(m.style.marginLeft != '250px' ? '250px' : '0' );
        }

    function closeNav() {
          //document.getElementById("brand").style.display = "none";
       // document.getElementById("bars").style.display = "block";
          document.getElementById("mySidenav").style.width = "0";
          document.getElementById("main").style.marginLeft= "0";
        };

        function showMenu(){
        const mainContent = document.getElementById('main');
            mainContent.innerHTML = `
            <div class="pos-container">
                      <div class="product-section" >
                  <h2>Product List</h2>
                  <div id="logo"><h1 style="color:green; text-align:center;margin-top:25%;">ABC Hardware</h1></div>
                  <table id="productTable" style="display:none;">
                      <thead i>
                          <tr >
                              <th>Product ID</th>
                              <th>Name</th>
                              <th>Quantity</th>
                              <th>Unit Price</th>
                              <th>Action</th>
                          </tr>
                      </thead>
                      <tbody id="productBody">
                          <!-- Products will be dynamically added here -->
                      </tbody>
                  </table>
              </div>
              <div class="checkout-section">
                  <div>
                      <h2>Enter Product ID or Cash Amount</h2>
                      <input type="text" id="inputField" autofocus style="width:95%;border:2px solid #9bddff;outline:1px solid #1e90ff; border-radius:15px;">
                  </div>
                  <div>
                      <h2>Total: Rs.<span id="totalAmount">0.00</span></h2>
                  </div>
                  <div>
                      <h2>Customer Payment: RS.<span id="customerPayment">0.00</span></h2>
                  </div>
                  <div>
                      <h2>Balance: Rs.<span id="balance">0.00</span></h2>
                  </div>
                  
                      <div class="virtual-keyboard">
                          <button onclick="pressKey('1')">1</button>
                          <button onclick="pressKey('2')">2</button>
                          <button onclick="pressKey('3')">3</button>
                          <button onclick="pressKey('4')">4</button>
                          <button onclick="pressKey('5')">5</button>
                          <button onclick="pressKey('6')">6</button>
                          <button onclick="pressKey('7')">7</button>
                          <button onclick="pressKey('8')">8</button>
                          <button onclick="pressKey('9')">9</button>
                          <button onclick="pressKey('0')">0</button>
                          <button onclick="pressKey('00')">00</button>
                          <button onclick="pressKey('000')">000</button>
                          <button onclick="pressLetter('p')">p</button>
                          <button onclick="clearInput()">Clear</button>
                          <button onclick="submitInput()">Enter</button>
                          <button onclick="backspace()"><b>&larr;</b></button>
          
                      </div>
                      <input type="button" value="Complete Order" onclick="completeOrder()" class="complete-order-btn">
              </div>
          </div>
            `;
      }

  document.addEventListener('DOMContentLoaded', async () => {
    const inputField = document.getElementById('inputField');
    inputField.focus();

    inputField.addEventListener('keydown', async (event) => {
    if (event.key === 'Enter') {
      await submitInput();
    }
  });

    try {
        items = await window.api.getItems();// Check the items structure
    } catch (error) {
        alert('Failed to load items: ' + error.message);
    }
});

function updateTotal() {
    total = order.reduce((sum, item) => sum + (item.retail_price * item.quantity), 0);
    document.getElementById('totalAmount').textContent = total.toFixed(2);
}

function updateOrderSummary() {
  if (order.length === 0) {
    document.getElementById('productTable').style.display="none";
  document.getElementById('logo').style.display="block";
  }
  else{
    document.getElementById('logo').style.display="none";
    document.getElementById('productTable').style.display="block";
  }
    const productBody = document.getElementById('productBody');
    productBody.innerHTML = '';
   

    order.forEach((orderItem, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td style="font-weight:bold;">${orderItem.custom_id}</td>
            <td style="font-weight:bold;">${orderItem.product_name}</td>
            <td><input type="number" value="${orderItem.quantity}" min="0" onchange="updateItemQuantity(${index}, this.value)" id="inputvalue"></td>
            <td style="font-weight:bold;">Rs.${orderItem.retail_price.toFixed(2)}</td>
            <td ><button onclick="removeFromOrder(${index})" class="removebutton">Remove</button></td>
        `;
        productBody.appendChild(tr);
        
    });

    updateTotal();
}

function updateItemQuantity(index, quantity) {
    const validQuantity = parseInt(quantity) || 0;
    order[index].quantity = validQuantity;
    updateTotal();
}

function removeFromOrder(index) {
    order.splice(index, 1);
    updateOrderSummary();
}

function pressKey(key) {
    const inputField = document.getElementById('inputField');
    inputField.value += key;
    inputField.focus();
}

function pressLetter(letter){
  const inputField = document.getElementById('inputField');
    inputField.value= letter;
    inputField.focus();
}

function clearInput() {
    const inputField = document.getElementById('inputField');
    inputField.value = '';
    inputField.focus();
}

function backspace() {
    const inputField = document.getElementById('inputField');
    inputField.value = inputField.value.slice(0, -1);
    inputField.focus();
}

async function submitInput() {
    const inputField = document.getElementById('inputField');
    const inputValue = inputField.value.trim();

    if (inputValue) {
        if (isNaN(inputValue)) {
            // Handle product ID
            await addProductToOrder(inputValue);
        } else {
            // Handle cash amount
            processCashAmount(parseFloat(inputValue));
        }
        clearInput();
    }
}

async function addProductToOrder(productId) {
  
    const product = items.find(item => item.custom_id.toLowerCase() === productId.toLowerCase());
    
    if (product) {
      
        const existingProductIndex = order.findIndex(item => item.custom_id.toLowerCase() === productId.toLowerCase());
        if (existingProductIndex > -1) {
            order[existingProductIndex].quantity += 1;
        } else {
          
            order.push({...product, quantity: 1});
        }
        
        updateOrderSummary();
    } else {
       
    }
}



function processCashAmount(cashAmount) {
    if (isNaN(cashAmount) || cashAmount < 0) {
        alert('Invalid cash amount.');
        return;
    }
    const balance = cashAmount - total;
    document.getElementById('customerPayment').textContent = cashAmount.toFixed(2);
    document.getElementById('balance').textContent = balance.toFixed(2);
}

async function completeOrder() {
    if (order.length === 0) {
        alert('No items in order!');
        return;
    }

    const cashAmount = parseFloat(document.getElementById('customerPayment').textContent) || 0;
    const balanceAmount = parseFloat(document.getElementById('balance').textContent) || 0;

    const totalPrice = total;

    if (isNaN(totalPrice) || totalPrice <= 0) {
        alert('Invalid total price.');
        return;
    }

    const orderDetails = {
        items: order.map(item => ({
            id: item.id,
            name: item.name,
            price: item.price,
            quantity: item.quantity
        })),
        totalPrice: totalPrice,
        cashAmount: cashAmount,
        balance: balanceAmount,
        date: new Date().toISOString()
    };

    try {
        const result = await window.api.saveOrder(orderDetails);
        const printResult = await window.api.printOrder(orderDetails);
        alert('Order saved and printed successfully.');
    } catch (error) {
        alert('Failed to save order: ' + error.message);
    }

    order = [];
    total = 0;
    clearInput();
    document.getElementById('customerPayment').textContent = '0.00';
    document.getElementById('balance').textContent = '0.00';
    updateOrderSummary();

}

function showSettings(){
        const mainContent = document.getElementById('main');
            mainContent.innerHTML = `
              <h2>Settings</h2>
              <div>
                <label for="sound-toggle">Keypad Sound</label>
      <input type="checkbox" id="sound-toggle" name="sound-toggle">

              </div>
            `;
      }

      function showInventory(){
        const mainContent = document.getElementById('main');
    mainContent.innerHTML = `
      <h2>Inventory</h2>
      <button class="sysitem" onclick="showAddSupplier(),showOverlay()">Add Supplier</button>
      <button class="sysitem" onclick="showAddProducts(),showOverlay()">Add Products</button>
      <button class="sysitem" onclick="showUpdateFoodItem(),showOverlay()">Update Food Item Price</button>
      <button class="sysitem"onclick="showRemoveOrder(),showOverlay()">Remove Order</button>
    <div id="overlay" style="display: none;">
  <div class="overlay-content" id="overlay-conten">
    <button class="close-button" id="mainclose" onclick="closeOverlays()">&times;</button>
    <button class="close-button" id="subclose" onclick="closeSubOverlay()" style="display:none;">&times;</button>
    <div id="overlaycon"></div>
    <div id="suboverlaycon"></div>
  </div>
</div>
      `;

      }

      function showOverlay() {
  document.getElementById("overlay").style.display = "flex";
}

function closeOverlays() {
  document.getElementById("overlay").style.display = "none";
}

function closeSubOverlay() {
  document.getElementById("subclose").style.display = "none";
  document.getElementById("suboverlaycon").style.display = "none";
  document.getElementById("mainclose").style.display = "block";
  document.getElementById("overlaycon").style.display = "block";
  

}


async function showAddSupplier() {
    try {
        const suppliers = await window.api.getSupplier();

        const managementContent = document.getElementById('overlaycon');
        
        if (suppliers == null || suppliers.length === 0) {
            managementContent.innerHTML = `
                <h4>No Suppliers Available</h4>
                <button onclick="showaddsup()" class="supplier" style="margin-top:10px;float:right;">Add Supplier</button>
            `;
        } else {
            managementContent.innerHTML = `
                <h3>Suppliers List</h3>
                <table id="suppliers-table" class="suppliers-table">
                    <thead>
                        <tr>
                            <th>Supplier Name</th>
                            <th>Mobile No.</th>
                            <th>Address</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="suppliers-list">
                        <!-- Suppliers will be added here dynamically -->
                    </tbody>
                </table>
                <button onclick="showaddsup()" class="supplier" style="margin-top:10px;float:right;">Add Supplier</button>
            `;

            populateSuppliersTable(suppliers);
        }
    } catch (error) {
        const messageElement = document.getElementById('add-supplier-message');
        messageElement.textContent = 'Failed to load suppliers.';
        messageElement.style.color = "red";
    }
}

function showaddsup(){
  document.getElementById("overlaycon").style.display = "none";
  document.getElementById("mainclose").style.display = "none";
  document.getElementById("subclose").style.display = "block";
  document.getElementById("suboverlaycon").style.display = "block";
  const managementContent = document.getElementById('suboverlaycon');
    managementContent.innerHTML = `
    <h3>Add Supplier</h3>
        <form onsubmit="return addSupplier()">
            <div class="form-group">
                <label for="new-supplier-name">Supplier Name</label>
                <input class="sysman" type="text" id="new-supplier-name" required>
            </div>
            <div class="form-group">
                <label for="new-mobile">Mobile No.</label>
                <input class="sysman" type="text" id="new-mobile" required>
            </div>
            <div class="form-group">
                <label for="new-address">Address</label>
                <input class="sysman" type="text" id="new-address" required>
            </div>
            <span id="add-supplier-message"></span>
            <button type="submit" style="float:right;" >Add Supplier</button>
        </form>
        `;

}



      async function addSupplier() {
    const newSupplierNameField = document.getElementById('new-supplier-name');
    const newMobileField = document.getElementById('new-mobile');
    const newAddressField = document.getElementById('new-address');
    const messageElement = document.getElementById('add-supplier-message');

    const newSupplierName = newSupplierNameField.value;
    const newMobile = newMobileField.value;
    const newAddress = newAddressField.value;

    if (isNaN(newMobile)) {
        messageElement.textContent = 'Invalid Mobile Number.';
        messageElement.style.color = "red";
        messageElement.style.fontWeight = "Bold";
    } else {
        try {
            const result = await window.api.addSupplier(newSupplierName, newMobile, newAddress);
            messageElement.textContent = 'Supplier added successfully.';
            messageElement.style.color = "green";
        } catch (error) {
            messageElement.textContent = 'Failed to add Supplier.';
            messageElement.style.color = "red";
        }
        messageElement.style.fontWeight = "Bold";

        // Clear the input fields
        newSupplierNameField.value = '';
        newMobileField.value = '';
        newAddressField.value = '';
    }
    // Hide the message after 3 seconds
    setTimeout(() => {
        messageElement.textContent = '';
    }, 2000);
    showAddSupplier();

    return false;
}

  

// Function to populate the suppliers table
function populateSuppliersTable(suppliers) {
    const suppliersList = document.getElementById('suppliers-list');
    suppliersList.innerHTML = '';

    suppliers.forEach((supplier, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${supplier.supplier_name}</td>
            <td>${supplier.mobile_number}</td>
            <td>${supplier.address}</td>
            <td>
                <button class="edit" onclick="editSupplier(${supplier.id})">Edit</button>
                <button class="delete" onclick="removeSupplier(${supplier.id})">Remove</button>
            </td>
        `;
        suppliersList.appendChild(row);
    });
}


// Example functions to handle edit and remove actions
// Function to handle supplier editing
async function editSupplier(supplierId) {
  showaddsup();
    try {
        const suppliers = await window.api.getSupplier();
        const supplier = suppliers.find(s => s.id === supplierId);

        if (supplier) {
          
            document.getElementById('new-supplier-name').value = supplier.supplier_name;
            document.getElementById('new-mobile').value = supplier.mobile_number;
            document.getElementById('new-address').value = supplier.address;

            // Change the form submission to update instead of add
            const form = document.getElementById('add-supplier-form');
            form.onsubmit = async (event) => {
                event.preventDefault();
                await updateSupplier(supplierId);
                form.onsubmit = addSupplier;  // Restore the form to add supplier functionality
            };
        }
    } catch (error) {
        console.error('Failed to load supplier for editing', error);
    }
}

// Function to update supplier details
async function updateSupplier(supplierId) {
    const newSupplierName = document.getElementById('new-supplier-name').value;
    const newMobile = document.getElementById('new-mobile').value;
    const newAddress = document.getElementById('new-address').value;
    const messageElement = document.getElementById('add-supplier-message');

    if (isNaN(newMobile)) {
        messageElement.textContent = 'Invalid Mobile Number.';
        messageElement.style.color = "red";
        messageElement.style.fontWeight = "Bold";
    } else {
        try {
            const result = await window.api.updateSupplier(supplierId, newSupplierName, newMobile, newAddress);
            messageElement.textContent = 'Supplier updated successfully.';
            messageElement.style.color = "green";

            // Reload the suppliers list after updating
            showAddSupplier();

            // Clear the input fields and restore form behavior
            document.getElementById('new-supplier-name').value = '';
            document.getElementById('new-mobile').value = '';
            document.getElementById('new-address').value = '';
        } catch (error) {
            messageElement.textContent = 'Failed to update Supplier.';
            messageElement.style.color = "red";
        }
        messageElement.style.fontWeight = "Bold";

        // Hide the message after 3 seconds
        setTimeout(() => {
            messageElement.textContent = '';
        }, 2000);
    }
}


// Function to handle supplier removal
async function removeSupplier(supplierId) {
    if (confirm('Are you sure you want to remove this supplier?')) {
        try {
            const result = await window.api.removeSupplier(supplierId);
            showAddSupplier(); 
        } catch (error) {
            console.error('Failed to remove supplier', error);
        }
    }
}


      function showAddProducts(){
        const managementContent = document.getElementById('overlaycon');
        managementContent.innerHTML = `
      <h3>Add Products</h3>
      <form id="add-product-form" onsubmit="return addProducts()">
        <div class="form-group">
          <label for="new-item-name">Supplier Name</label>
          <select class="sysman"  style="width:700px;" id="new-supplier-name" required></select>
        </div>
        <div class="form-group">
          <label for="new-item-name">Product Category</label>
          <select class="sysman"   style="width:700px; " id="new-supplier-name" required></select>
        </div>
        <div class="form-group">
          <label for="new-item-price">Product Name</label>
          <input class="sysman" type="text" id="product-name" step="0.01" required>
        </div>
         <div class="form-group">
          <label for="new-item-price">Product Quantity</label>
          <input class="sysman" type="text" id="product-count" step="0.01" required>
        </div>
        <div class="form-group">
          <label for="new-item-price">Stock Price</label>
          <input class="sysman" type="text" id="stock-price" step="0.01" required>
        </div>
        <div class="form-group">
          <label for="new-item-price">Wholesale Price</label>
          <input class="sysman" type="text" id="wholesale-price" step="0.01" required>
        </div>
         <div class="form-group">
          <label for="new-item-price">Discount</label>
          <input class="sysman" type="text" id="discount" step="0.01" required>
        </div>
        <span id="add-product-message"></span>
        <button type="submit" style="float:right;">Add Supplier</button>
      </form>
        `;

      }

      async function addProducts(){
        const newSupplierNameField = document.getElementById('new-supplier-name');
        const productnameField = document.getElementById('product-name');
        const productcountField = document.getElementById('product-count');
        const stockpriceField = document.getElementById('stock-price');
        const wholesalepriceField = document.getElementById('wholesale-price');
        const discountField = document.getElementById('discount');
        const messageElement = document.getElementById('add-product-message');

        const newSupplierName=newSupplierNameField.value;
        const productname=productnameField.value;
        const productcount=productcountField.value;
        const stockprice= stockpriceField.value;
        const wholesaleprice=wholesalepriceField.value;
        const discount= sdiscountField.value;

        if (isNaN(productcount) || isNaN(stockprice)|| isNaN (wholesaleprice)||isNaN(discount) ) {
          messageElement.textContent = 'Invalid Price Value.';
          messageElement.style.color="red";
          messageElement.style.fontWeight="Bold";
         }else{

        try {
            const result = await window.api.addProduct(newSupplierName, productname, productcount, stockprice, wholesaleprice, discount);
            messageElement.textContent = 'Product added successfully.';
            messageElement.style.color="green";

        } catch (error) {
            messageElement.textContent = 'Failed to add Product.';
            messageElement.style.color="red";
        }
        messageElement.style.fontWeight="Bold";

        // Clear the input fields
        newSupplierNameField.value = '';
        newMobileField.value = '';
        newAddressField.value='';
      }
        // Hide the message after 3 seconds
        setTimeout(() => {
            messageElement.textContent = '';
        }, 2000);

        return false;
        
      }


    async function showOrderReports() {
        const mainContent = document.getElementById('main');
        mainContent.innerHTML = `
          <h2>Order Reports</h2>
          <div class="reportselect">
            <label for="start-date">Start Date:</label>
            <input type="date" id="start-date"><br><br>
            <label for="end-date">End Date:&nbsp;</label>
            <input type="date" id="end-date"><br><br>
            </div>
            <button onclick="loadFilteredOrders()">Filter</button>
          
          <div id="order-report"></div>
        `;
      }


          </script>
      </body>
      </html>
      
